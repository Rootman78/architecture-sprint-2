## –°–ø—Ä–∏–Ω—Ç 2: –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è

## –£—Å–ª–æ–≤–∏–µ

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —Å –∫–æ–ª–ª–µ–≥–æ–π —Ä–µ—à–∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω. –¢–∞–º –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã –¥–ª—è —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤. –í—ã —Å–¥–µ–ª–∞–ª–∏ P–æC –¥–ª—è —Å–∞–π—Ç–∞. –ï–≥–æ –±—ç–∫–µ–Ω–¥ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤.
–ó–∞—Ç–µ–º –≤—ã —Ä–µ—à–∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–∫—Ü–∏—é ¬´–ß—ë—Ä–Ω–∞—è –ø—è—Ç–Ω–∏—Ü–∞¬ª –∏ –≤—ã–ø—É—Å—Ç–∏–ª–∏ –∫–ª–∞—Å—Å–Ω—É—é —Ä–µ–∫–ª–∞–º—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–≤–ª–µ–∫–ª–∞ –º–Ω–æ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç —Å–∞–π—Ç –ø–µ—Ä–µ—Å—Ç–∞–ª —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å –ø–æ—Ç–æ–∫–æ–º –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —É–ø–∞–ª –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤.
–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø—Ä–∏—á–∏–Ω—ã —Å–±–æ—è, –≤—ã –ø—Ä–æ–≤–µ–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ. –í—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ –æ–¥–∏–Ω –∏–∑ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ ‚Äî API, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö, ‚Äî –Ω–µ —Å–ø—Ä–∞–≤–∏–ª—Å—è —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π –∏ –ø–æ–≤–ª–∏—è–ª –Ω–∞ —Ä–∞–±–æ—Ç—É –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ó–∞–±–∏–ª–∏—Å—å –æ—á–µ—Ä–µ–¥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–æ–≤, –∏ —Ç–∞—Å–∫–∏ –Ω–∞—á–∞–ª–∏ –æ—Ç–≤–∞–ª–∏–≤–∞—Ç—å—Å—è –ø–æ —Ç–∞–π–º-–∞—É—Ç—É. –í –∏—Ç–æ–≥–µ –≤—ã –ø–æ—Ç–µ—Ä—è–ª–∏ –º–Ω–æ–≥–æ –∑–∞–∫–∞–∑–æ–≤ –∏ —É–ø—É—Å—Ç–∏–ª–∏ –ø—Ä–∏–±—ã–ª—å. 
–í–æ—Ç —Å—Ö–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–æ–±—Ä–∞–∂–∞–µ—Ç –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –æ–¥–Ω—É –Ω–æ–¥—É MongoDB:

–°–∫–æ—Ä–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É—Å—Ç—Ä–æ–∏—Ç—å –µ—â—ë –æ–¥–Ω—É —Ä–∞—Å–ø—Ä–æ–¥–∞–∂—É. –ß—Ç–æ–±—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ –Ω–µ–π, –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø–æ–≤—ã—Å–∏—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —É–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
–í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –≤–∞–º –Ω—É–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å MongoDB, –∏ –ø–æ–≤—ã—Å–∏—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫–ª—é—á–µ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
–≠—Ç—É –∑–∞–¥–∞—á—É –≤—ã –∏ –±—É–¥–µ—Ç–µ —Ä–µ—à–∞—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ.
–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ —Ä–∞–±–æ—Ç–µ
–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub –ª–µ–∂–∏—Ç –ø—Ä–æ–µ–∫—Ç –Ω–∞ Docker Compose. –û–Ω —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–µ–Ω–¥ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: pymongo-api –∏ single –∏–Ω—Å—Ç–∞–Ω—Å MongoDB.
–°–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ä–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ —Å–≤–æ–π –ª–∏—á–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–ø–∏—Å–∞–Ω–∞ –≤ README.md.
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É 8080.
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ /docs.
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞ Docker Compose, –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 CPU –∏ 4 –ì–± –û–ó–£.
### –ó–∞–¥–∞–Ω–∏–µ 1. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
–í–∞–º –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ. –ß—Ç–æ–±—ã —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, –Ω—É–∂–Ω–æ —Ä–∞—Å–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è. 
üîπ –í–æ—Ç —à–∞–±–ª–æ–Ω —Å—Ö–µ–º—ã –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ draw.io.  –°–∫–∞—á–∞–π—Ç–µ –µ–≥–æ.
–ù–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞ –≤–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ —Å—Ö–µ–º–æ–π –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤. –í–æ—Ç –ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ —à–∞–≥–∞:
–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã. –ò–∑–æ–±—Ä–∞–∑–∏—Ç–µ, –∫–∞–∫ –≤—ã –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MongoDB –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –î–≤—É—Ö —à–∞—Ä–¥–æ–≤ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.
–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã. –ò–∑–æ–±—Ä–∞–∑–∏—Ç–µ, –∫–∞–∫ —Ä–µ–∞–ª–∏–∑—É–µ—Ç–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é MongoDB –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏. –ß—Ç–æ–±—ã —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã –∏ –¥–æ—Ä–∞–±–æ—Ç–∞–π—Ç–µ –µ–≥–æ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞—Ä–¥–∞ –±—ã–ª–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è. –ö–∞–∂–¥—ã–π —à–∞—Ä–¥ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø–æ —Ç—Ä–∏ —Ä–µ–ø–ª–∏–∫–∏.
–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Ç—Ä–µ—Ç–∏–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã. –ò–∑–æ–±—Ä–∞–∑–∏—Ç–µ, –∫–∞–∫ —Ä–µ–∞–ª–∏–∑—É–µ—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –µ—â—ë –±–æ–ª—å—à–µ–≥–æ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ß—Ç–æ–±—ã —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã –∏ –¥–æ–±–∞–≤—å—Ç–µ –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫ MongoDB.
–í—Å–µ–≥–æ —Ç–∞–∫–∏—Ö —Å—Ö–µ–º —É –≤–∞—Å –ø–æ–ª—É—á–∏—Ç—Å—è –ø—è—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ 5 –∏ 6 –∑–∞–¥–∞–Ω–∏—è—Ö —Ç–æ–∂–µ –Ω—É–∂–Ω–æ –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ö–µ–º–æ–π. 
–†–µ–≤—å—é–µ—Ä –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ –∏—Ç–æ–≥–æ–≤—É—é —Å—Ö–µ–º—É. –ù–∞ –Ω–µ–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤–Ω–µ—Å—ë—Ç–µ –≤ –ø—Ä–æ–µ–∫—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π. 
–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ö–µ–º—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–∞–∫ –ø—Ä–æ—â–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.
–ù–∞ —á—Ç–æ –±—É–¥–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–≤—å—é–µ—Ä
–ù–∞ —Å—Ö–µ–º–∞—Ö –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –≤—Å–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –∞ —Ç–∞–∫–∂–µ –∏—Ö —Ç–∏–ø—ã (pymongo-api, configSrv, redis, shard1-1, shard1-2 –∏ —Ç. –ø.). –ò–º–µ–Ω–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å–∞–Ω—ã –≤ —É—Ä–æ–∫–∞—Ö.
–í—ã–¥–µ–ª–∏—Ç–µ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏.
–û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ —Å–µ—Ç–µ–≤—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.
### –ó–∞–¥–∞–Ω–∏–µ 2. –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏—Å—Ö–æ–¥–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ compose.yaml –ø–æ–¥ –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º mongo-sharding.
–í —Ñ–∞–π–ª–µ compose.yaml –∏–∑–º–µ–Ω–∏—Ç–µ –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ name: mongo-sharding.
–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ compose.yaml —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã. –ó–∞ –æ—Å–Ω–æ–≤—É –º–æ–∂–µ—Ç–µ –≤–∑—è—Ç—å –ø—Ä–∏–º–µ—Ä –∏–∑ —É—Ä–æ–∫–∞ –ø—Ä–æ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ.
–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –ø—Ä–æ–µ–∫—Ç–æ–º —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª README.md. –û–ø–∏—à–∏—Ç–µ —Ç–∞–º —à–∞–≥–∏ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ MongoDB.
üí° –° –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ shell-—Å–∫—Ä–∏–ø—Ç–∞ –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –Ω–∞ –∏–Ω—Å—Ç–∞–Ω—Å–∞—Ö MongoDB:

docker compose exec -T <service-name> mongosh --port <mongo port> --quiet <<EOF
<mongosh commands here>
EOF 
    –ù–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞–∫ –≤—ã–≥–ª—è–¥—è—Ç –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –ë–î somedb –∏–Ω—Å—Ç–∞–Ω—Å–∞ shard1:

docker compose exec -T shard1 mongosh --port 27018 --quiet <<EOF
use somedb
db.helloDoc.countDocuments()
EOF 
üí° –ù–æ–º–µ—Ä–∞ –ø–æ—Ä—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ MongoDB –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
–ù–∞–∑–æ–≤–∏—Ç–µ –ë–î somedb, –∞ –∫–æ–ª–ª–µ–∫—Ü–∏—é ‚Äî helloDoc.
–ù–∞ —á—Ç–æ –±—É–¥–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–≤—å—é–µ—Ä
–ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ README.md –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ (‚â• 1000), –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∏–∑ —à–∞—Ä–¥–æ–≤.
### –ó–∞–¥–∞–Ω–∏–µ 3. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–æ–µ–∫—Ç–æ–º mongo-sharding –ø–æ–¥ –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º mongo-sharding-repl.
–í —Ñ–∞–π–ª–µ compose.yaml –∏–∑–º–µ–Ω–∏—Ç–µ –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ name: mongo-sharding-repl.
–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ compose.yaml —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã. –ó–∞ –æ—Å–Ω–æ–≤—É –º–æ–∂–µ—Ç–µ –≤–∑—è—Ç—å –ø—Ä–∏–º–µ—Ä –∏–∑ —É—Ä–æ–∫–∞ –ø—Ä–æ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ.
–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –ø—Ä–æ–µ–∫—Ç–æ–º —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª README.md. –û–ø–∏—à–∏—Ç–µ —Ç–∞–º —à–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å, —á—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞—Ä–¥–∞ –≤ MongoDB.
üí° –ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ, —á—Ç–æ —Å –ø–æ–º–æ—â—å—é shell-—Å–∫—Ä–∏–ø—Ç–∞ –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥.
–ù–∞ —á—Ç–æ –±—É–¥–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–≤—å—é–µ—Ä
–ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ README.md –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ (‚â• 1000), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∏–∑ —à–∞—Ä–¥–æ–≤, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–ª–∏–∫.
### –ó–∞–¥–∞–Ω–∏–µ 4. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–æ–µ–∫—Ç–æ–º mongo-sharding-repl –ø–æ–¥ –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º sharding-repl-cache.
–í —Ñ–∞–π–ª–µ compose.yaml –∏–∑–º–µ–Ω–∏—Ç–µ –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ name: sharding-repl-cache.
–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ compose.yaml —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã. –í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–∞ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∏–∑ —É—Ä–æ–∫–∞ –ø—Ä–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ.
–ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:

REDIS_URL: "redis://<redis-service-name>:6379" 
–í–º–µ—Å—Ç–æ <redis-service-name> –Ω–∞–ø–∏—à–∏—Ç–µ –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ redis.
‚òù –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis –≤ Single Node —Ä–µ–∂–∏–º–µ. –ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç REDIS_URL –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ /<collection_name>/users. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è.
–ù–∞ —á—Ç–æ –±—É–¥–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–≤—å—é–µ—Ä
–ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ README.md –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ (‚â• 1000), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∏–∑ —à–∞—Ä–¥–æ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–ª–∏–∫.
–í—Ç–æ—Ä–æ–π –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ /<collection_name>/users –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è <100–º—Å.
### –ó–∞–¥–∞–Ω–∏–µ 5. Service Discovery –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Å API Gateway
–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —É –≤–∞—Å —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –≠—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–∏ –≤ —Å–ª—É—á–∞–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏. –¢–∞–∫–∂–µ –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –Ω–µ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
–ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –Ω–∞ –∫–∞–∫–æ–π –∏–∑ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –ø–æ–¥–∞–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫. –î–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ API Gateway.
–ï—â—ë –Ω—É–∂–Ω–æ –∫–∞–∫-—Ç–æ —Å–æ–æ–±—â–∞—Ç—å API Gateway –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã –≤ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –∏–ª–∏, –Ω–∞–ø—Ä–æ—Ç–∏–≤, —É–±—Ä–∞—Ç—å –æ—Ç—Ç—É–¥–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Hashicorp Consul –¥–ª—è Service Discovery.
–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å
–°–æ—Å—Ç–∞–≤—å—Ç–µ —á–µ—Ç–≤—ë—Ä—Ç—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã. –ò–∑–æ–±—Ä–∞–∑–∏—Ç–µ, –∫–∞–∫ –≤—ã —Ä–µ–∞–ª–∏–∑—É–µ—Ç–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç—Ä–µ—Ç–∏–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã –∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–∞ –Ω–µ–≥–æ API Gateway –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∏ Consul –¥–ª—è Service Discovery.
–ù–∞ —á—Ç–æ –±—É–¥–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–≤—å—é–µ—Ä
–ù–∞ —Å—Ö–µ–º–µ –Ω—É–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏–Ω—Å—Ç–∞–Ω—Å—ã Consul –∏ API Gateway. –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ —Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –Ω–∏–º–∏ —Å –ø–æ–º–æ—â—å—é —Å—Ç—Ä–µ–ª–æ–∫.
### –ó–∞–¥–∞–Ω–∏–µ 6. CDN
–ß—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN.
–°–æ—Å—Ç–∞–≤—å—Ç–µ –ø—è—Ç—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—ã —Ä–µ–∞–ª–∏–∑—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CDN. –î–ª—è —ç—Ç–æ–≥–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–æ—à–ª—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å—Ö–µ–º—ã –∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–∞ –Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å CDN –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö.

## –†–µ—à–µ–Ω–∏–µ

### –ó–∞–¥–∞–Ω–∏–µ 1
–í —Ñ–∞–π–ª–µ task1_kashuba.drawio

### –ó–∞–¥–∞–Ω–∏–µ 2 
–í –ø–∞–ø–∫–µ mongo-sharding –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª–µ README.md –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ docker compose up -d

### –ó–∞–¥–∞–Ω–∏–µ 3
–í –ø–∞–ø–∫–µ mongo-sharding-repl –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª–µ README.md –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ docker compose up -d

### –ó–∞–¥–∞–Ω–∏–µ 4 
–í –ø–∞–ø–∫–µ sharding-repl-cache –æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª–µ README.md –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ docker compose up -d

### –ó–∞–¥–∞–Ω–∏–µ 5 
–í —Ñ–∞–π–ª–µ task1_kashuba.drawio

### –ó–∞–¥–∞–Ω–∏–µ 6
–í —Ñ–∞–π–ª–µ task1_kashuba.drawio